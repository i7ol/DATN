<div class="auth-backdrop">
  <div class="auth-container">
    <div class="auth-card" [class.register-mode]="!isLoginMode">
      
      <button class="close-btn" mat-icon-button (click)="closeDialog()">
        <mat-icon>close</mat-icon>
      </button>

      <div class="auth-content">
        <div class="auth-header">
          <div class="logo-placeholder">
            <mat-icon color="primary">shopping_bag</mat-icon>
          </div>
          <h2>{{ isLoginMode ? "Chào mừng trở lại" : "Tạo tài khoản mới" }}</h2>
          <p class="subtitle">
            {{ isLoginMode ? "Đăng nhập để tiếp tục mua sắm cùng chúng tôi" : "Tham gia cùng hàng nghìn khách hàng mỗi ngày" }}
          </p>
        </div>

        <mat-tab-group
          class="auth-tabs custom-tabs"
          [selectedIndex]="isLoginMode ? 0 : 1"
          (selectedTabChange)="onTabChange($event)"
          centered
        >
          <mat-tab label="ĐĂNG NHẬP">
            <form class="auth-form" [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()">
              <mat-form-field appearance="fill" class="full-width">
                <mat-label>Tên đăng nhập</mat-label>
                <input matInput formControlName="username" placeholder="Ví dụ: nva123">
                <mat-icon matSuffix>person_outline</mat-icon>
              </mat-form-field>

              <mat-form-field appearance="fill" class="full-width">
                <mat-label>Mật khẩu</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password">
                <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword">
                  <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                </button>
              </mat-form-field>

              <div class="form-options">
                <mat-checkbox color="primary">Ghi nhớ tôi</mat-checkbox>
                <a href="javascript:void(0)" class="forgot-link">Quên mật khẩu?</a>
              </div>

              <button mat-flat-button color="primary" class="main-btn" [disabled]="loginLoading || loginForm.invalid">
                <mat-progress-spinner *ngIf="loginLoading" diameter="20" mode="indeterminate"></mat-progress-spinner>
                <span *ngIf="!loginLoading">Đăng nhập</span>
              </button>
            </form>
          </mat-tab>

          <mat-tab label="ĐĂNG KÝ">
            <form class="auth-form register-grid" [formGroup]="registerForm" (ngSubmit)="onRegisterSubmit()">
              <mat-form-field appearance="fill">
                <mat-label>Tên đăng nhập</mat-label>
                <input matInput formControlName="username">
              </mat-form-field>

              <mat-form-field appearance="fill">
                <mat-label>Số điện thoại</mat-label>
                <input matInput formControlName="phone">
              </mat-form-field>

              <mat-form-field appearance="fill" class="full-span">
                <mat-label>Email liên hệ</mat-label>
                <input matInput type="email" formControlName="email">
              </mat-form-field>

              <mat-form-field appearance="fill">
                <mat-label>Mật khẩu</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password">
              </mat-form-field>

              <mat-form-field appearance="fill">
                <mat-label>Xác nhận</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="confirmPassword">
              </mat-form-field>

              <button mat-flat-button color="primary" class="main-btn full-span" [disabled]="registerLoading || registerForm.invalid">
                <span>{{ registerLoading ? 'Đang khởi tạo...' : 'Tạo tài khoản' }}</span>
              </button>
            </form>
          </mat-tab>
        </mat-tab-group>
      </div>
    </div>
  </div>
</div>